{% extends "base.html" %}

{% block title %}Import CSV{% endblock %}

{% block content %}
<h2 style="margin-bottom: 1.5rem; color: #1a5f7a;">Import Mappings from CSV</h2>

<div class="card">
    <form method="post" action="/import" enctype="multipart/form-data">
        <div class="form-group">
            <label for="file">Select CSV File</label>
            <input type="file" id="file" name="file" accept=".csv" required>
        </div>
        
        <button type="submit" class="btn">üìÅ Import File</button>
    </form>
</div>

<div class="card">
    <h2>CSV Format</h2>
    <p style="margin-bottom: 1rem;">Your CSV file should have a header row with the following columns:</p>
    
    <table>
        <thead>
            <tr>
                <th>Column</th>
                <th>Required</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><code>ip_address</code></td>
                <td>*</td>
                <td>Single IP address (e.g., 192.168.1.100)</td>
            </tr>
            <tr>
                <td><code>subnet</code></td>
                <td>*</td>
                <td>CIDR notation (e.g., 192.168.1.0/24)</td>
            </tr>
            <tr>
                <td><code>user_id</code></td>
                <td>Yes</td>
                <td>Unique user identifier</td>
            </tr>
            <tr>
                <td><code>user_name</code></td>
                <td>Yes</td>
                <td>Display name</td>
            </tr>
            <tr>
                <td><code>department</code></td>
                <td>No</td>
                <td>Department or team name</td>
            </tr>
            <tr>
                <td><code>location</code></td>
                <td>No</td>
                <td>Office location</td>
            </tr>
            <tr>
                <td><code>description</code></td>
                <td>No</td>
                <td>Additional notes</td>
            </tr>
        </tbody>
    </table>
    
    <p style="margin-top: 1rem; color: #666;">* Either ip_address or subnet is required for each row</p>
</div>

<div class="card">
    <h2>Example CSV</h2>
    <pre style="background: #f5f5f5; padding: 1rem; border-radius: 6px; overflow-x: auto;">ip_address,subnet,user_id,user_name,department,location
192.168.1.100,,jsmith,John Smith,Engineering,Johannesburg
192.168.1.101,,mjones,Mary Jones,Sales,Cape Town
,10.0.0.0/24,dhcp-pool,DHCP Users,General,All Offices
192.168.2.50,,aadmin,Admin Account,IT,Data Center</pre>
    
    <a href="#" onclick="downloadExample(); return false;" class="btn btn-secondary" style="margin-top: 1rem;">‚¨áÔ∏è Download Example CSV</a>
</div>
{% endblock %}

{% block scripts %}
<script>
function downloadExample() {
    const csv = `ip_address,subnet,user_id,user_name,department,location,description
192.168.1.100,,jsmith,John Smith,Engineering,Johannesburg,Developer workstation
192.168.1.101,,mjones,Mary Jones,Sales,Cape Town,Sales laptop
,10.0.0.0/24,dhcp-pool,DHCP Users,General,All Offices,Dynamic IP pool
192.168.2.50,,aadmin,Admin Account,IT,Data Center,Server admin`;
    
    const blob = new Blob([csv], { type: 'text/csv' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'identity-mappings-example.csv';
    a.click();
    URL.revokeObjectURL(url);
}
</script>
{% endblock %}
