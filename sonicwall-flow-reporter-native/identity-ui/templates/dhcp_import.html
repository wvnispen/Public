{% extends "base.html" %}

{% block title %}Import DHCP Leases{% endblock %}

{% block content %}
<h2 style="margin-bottom: 1.5rem; color: #1a5f7a;">Import Static DHCP Leases</h2>

<div class="card">
    <form method="post" action="/dhcp/import" enctype="multipart/form-data">
        <div class="form-group">
            <label for="format_type">DHCP Server / Format</label>
            <select id="format_type" name="format_type" required>
                <option value="">-- Select Format --</option>
                <optgroup label="Firewall / Router">
                    <option value="sonicwall">SonicWall DHCP Export</option>
                    <option value="opnsense">OPNsense / pfSense</option>
                    <option value="mikrotik">MikroTik RouterOS</option>
                </optgroup>
                <optgroup label="DHCP Servers">
                    <option value="isc">ISC DHCP (dhcpd.conf)</option>
                    <option value="dnsmasq">dnsmasq</option>
                    <option value="windows">Windows DHCP Server</option>
                </optgroup>
                <optgroup label="Generic">
                    <option value="csv">Generic CSV (auto-detect columns)</option>
                </optgroup>
            </select>
        </div>
        
        <div class="form-group">
            <label for="file">Select Export File</label>
            <input type="file" id="file" name="file" accept=".csv,.txt,.conf,.xml,.rsc" required>
        </div>
        
        <hr style="margin: 1.5rem 0; border: none; border-top: 1px solid #eee;">
        
        <p style="color: #666; margin-bottom: 1rem;">Optional: Set default values for all imported entries</p>
        
        <div class="form-row">
            <div class="form-group">
                <label for="default_department">Default Department</label>
                <input type="text" id="default_department" name="default_department" placeholder="e.g., IT, Sales, Engineering">
            </div>
            <div class="form-group">
                <label for="default_location">Default Location</label>
                <input type="text" id="default_location" name="default_location" placeholder="e.g., Main Office, Branch 1">
            </div>
        </div>
        
        <button type="submit" class="btn">ðŸ“¥ Import DHCP Leases</button>
    </form>
</div>

<div class="card">
    <h2>Supported Formats</h2>
    
    <h3 style="margin-top: 1rem; color: #1a5f7a;">SonicWall</h3>
    <p>Export from: <strong>Network â†’ DHCP Server â†’ DHCP Server Leases</strong> (Export or copy static leases)</p>
    <pre style="background: #f5f5f5; padding: 0.75rem; border-radius: 6px; font-size: 0.85rem;">192.168.1.100,00:1A:2B:3C:4D:5E,Workstation-01
192.168.1.101,00:1A:2B:3C:4D:5F,Laptop-Sales</pre>
    
    <h3 style="margin-top: 1.5rem; color: #1a5f7a;">ISC DHCP (dhcpd.conf)</h3>
    <p>Copy static host entries from your dhcpd.conf file</p>
    <pre style="background: #f5f5f5; padding: 0.75rem; border-radius: 6px; font-size: 0.85rem;">host workstation-01 {
    hardware ethernet 00:1a:2b:3c:4d:5e;
    fixed-address 192.168.1.100;
}
host laptop-sales {
    hardware ethernet 00:1a:2b:3c:4d:5f;
    fixed-address 192.168.1.101;
}</pre>
    
    <h3 style="margin-top: 1.5rem; color: #1a5f7a;">dnsmasq</h3>
    <p>Copy dhcp-host lines from your dnsmasq.conf</p>
    <pre style="background: #f5f5f5; padding: 0.75rem; border-radius: 6px; font-size: 0.85rem;">dhcp-host=00:1a:2b:3c:4d:5e,workstation-01,192.168.1.100
dhcp-host=00:1a:2b:3c:4d:5f,laptop-sales,192.168.1.101</pre>
    
    <h3 style="margin-top: 1.5rem; color: #1a5f7a;">Windows DHCP Server</h3>
    <p>Export reservations from PowerShell:</p>
    <pre style="background: #f5f5f5; padding: 0.75rem; border-radius: 6px; font-size: 0.85rem;">Get-DhcpServerv4Reservation -ScopeId 192.168.1.0 | Export-Csv -Path dhcp_leases.csv</pre>
    
    <h3 style="margin-top: 1.5rem; color: #1a5f7a;">MikroTik</h3>
    <p>Export from terminal:</p>
    <pre style="background: #f5f5f5; padding: 0.75rem; border-radius: 6px; font-size: 0.85rem;">/ip dhcp-server lease export file=dhcp-leases</pre>
    
    <h3 style="margin-top: 1.5rem; color: #1a5f7a;">OPNsense / pfSense</h3>
    <p>Export DHCP static mappings from: <strong>Services â†’ DHCPv4 â†’ [Interface]</strong> (Backup or export)</p>
    
    <h3 style="margin-top: 1.5rem; color: #1a5f7a;">Generic CSV</h3>
    <p>Any CSV with columns for IP, MAC, and hostname. Columns are auto-detected:</p>
    <pre style="background: #f5f5f5; padding: 0.75rem; border-radius: 6px; font-size: 0.85rem;">ip_address,mac_address,hostname
192.168.1.100,00:1A:2B:3C:4D:5E,Workstation-01
192.168.1.101,00:1A:2B:3C:4D:5F,Laptop-Sales</pre>
</div>
{% endblock %}
